INFO:training log:hparams...
INFO:training log:d_model: 6Â - batch size 64 - full model? False - dff: 0
INFO:training log:SMC Transformer for 10 particles
INFO:training log:predictions shape: (64, 10, 24, 1)
INFO:training log:Epoch 1/30
INFO:training log:train loss: 18.123 - val loss: 12.263
INFO:training log:train mse metric from avg particule: 12.203 - val mse metric from avg particule: 9.413
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.25878006> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.49015164> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.49026462> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.49022806> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.49029833>
INFO:training log:Time taken for 1 epoch: 294.094051361084 secs
INFO:training log:Epoch 2/30
INFO:training log:train loss: 5.502 - val loss: -0.727
INFO:training log:train mse metric from avg particule: 6.329 - val mse metric from avg particule: 3.414
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.27852443> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.45991367> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.46101183> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.46045208> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.46121326>
INFO:training log:Time taken for 1 epoch: 298.0358922481537 secs
INFO:training log:Epoch 3/30
INFO:training log:train loss: -4.411 - val loss: -7.218
INFO:training log:train mse metric from avg particule: 2.104 - val mse metric from avg particule: 1.411
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.30043888> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.40924817> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.41160142> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.41055208> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.412196>
INFO:training log:Time taken for 1 epoch: 305.48452734947205 secs
INFO:training log:Epoch 4/30
INFO:training log:train loss: -9.511 - val loss: -12.214
INFO:training log:train mse metric from avg particule: 1.366 - val mse metric from avg particule: 1.364
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.3373847> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.3381979> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.34101477> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.34007484> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.34298944>
INFO:training log:Time taken for 1 epoch: 310.0661323070526 secs
INFO:training log:Epoch 5/30
INFO:training log:train loss: -15.848 - val loss: -20.299
INFO:training log:train mse metric from avg particule: 1.309 - val mse metric from avg particule: 1.282
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.3971867> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.24446724> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.2474291> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.24671167> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.25133866>
INFO:training log:Time taken for 1 epoch: 314.4432809352875 secs
INFO:training log:Epoch 6/30
INFO:training log:train loss: -27.208 - val loss: -36.700
INFO:training log:train mse metric from avg particule: 1.240 - val mse metric from avg particule: 1.252
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.4729328> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.12255722> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.12573962> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.12507015> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.13155645>
INFO:training log:Time taken for 1 epoch: 318.91948986053467 secs
INFO:training log:Epoch 7/30
INFO:training log:train loss: -79.236 - val loss: -137.203
INFO:training log:train mse metric from avg particule: 1.211 - val mse metric from avg particule: 1.241
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.5648034> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.004416908> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.0013385683> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.0043827263> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.0005348005>
INFO:training log:Time taken for 1 epoch: 326.07067704200745 secs
INFO:training log:Epoch 8/30
INFO:training log:train loss: -127.243 - val loss: -132.994
INFO:training log:train mse metric from avg particule: 1.205 - val mse metric from avg particule: 1.228
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.67193127> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.00039964681> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.0013493889> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.0063438886> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.008303721>
INFO:training log:Time taken for 1 epoch: 330.7309465408325 secs
INFO:training log:Epoch 9/30
INFO:training log:train loss: -111.996 - val loss: -112.673
INFO:training log:train mse metric from avg particule: 1.202 - val mse metric from avg particule: 1.228
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.7913036> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.0046706866> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.010738355> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.00637241> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.0026504032>
INFO:training log:Time taken for 1 epoch: 336.98703050613403 secs
INFO:training log:Epoch 10/30
INFO:training log:train loss: -117.472 - val loss: -139.785
INFO:training log:train mse metric from avg particule: 1.203 - val mse metric from avg particule: 1.234
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=0.9179257> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.0013800755> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.009135535> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=-0.0008147697> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.00090110686>
INFO:training log:Time taken for 1 epoch: 343.3975884914398 secs
INFO:training log:Epoch 11/30
INFO:training log:train loss: -117.224 - val loss: -117.230
INFO:training log:train mse metric from avg particule: 1.204 - val mse metric from avg particule: 1.232
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.0426571> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.0042136847> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.0015921898> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.0049054227> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.012158599>
INFO:training log:Time taken for 1 epoch: 349.2541935443878 secs
INFO:training log:Epoch 12/30
INFO:training log:train loss: -122.538 - val loss: -106.405
INFO:training log:train mse metric from avg particule: 1.202 - val mse metric from avg particule: 1.228
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.1463403> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.008611032> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.0049111703> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.006696485> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.008598568>
INFO:training log:Time taken for 1 epoch: 354.3629789352417 secs
INFO:training log:Epoch 13/30
INFO:training log:train loss: -112.006 - val loss: -105.518
INFO:training log:train mse metric from avg particule: 1.204 - val mse metric from avg particule: 1.237
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.1929057> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.0014602983> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.0104319835> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.015787374> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.011709596>
INFO:training log:Time taken for 1 epoch: 358.49188113212585 secs
INFO:training log:Epoch 14/30
INFO:training log:train loss: -108.786 - val loss: -106.691
INFO:training log:train mse metric from avg particule: 1.206 - val mse metric from avg particule: 1.246
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2097156> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.008575215> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.0036263943> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.0059884936> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.012409854>
INFO:training log:Time taken for 1 epoch: 362.54802560806274 secs
INFO:training log:Epoch 15/30
INFO:training log:train loss: -107.948 - val loss: -96.163
INFO:training log:train mse metric from avg particule: 1.206 - val mse metric from avg particule: 1.241
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2074145> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.010902257> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.014509563> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=-0.011492522> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.007355994>
INFO:training log:Time taken for 1 epoch: 369.0968568325043 secs
INFO:training log:Epoch 16/30
INFO:training log:train loss: -99.021 - val loss: -92.383
INFO:training log:train mse metric from avg particule: 1.203 - val mse metric from avg particule: 1.227
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2044474> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.017984679> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.0078532575> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.017835587> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.009988613>
INFO:training log:Time taken for 1 epoch: 378.31717824935913 secs
INFO:training log:Epoch 17/30
INFO:training log:train loss: -110.442 - val loss: -99.501
INFO:training log:train mse metric from avg particule: 1.206 - val mse metric from avg particule: 1.242
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2057633> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.0122965695> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.0054906877> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.0057495595> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.019820826>
INFO:training log:Time taken for 1 epoch: 380.92689394950867 secs
INFO:training log:Epoch 18/30
INFO:training log:train loss: -106.369 - val loss: -110.137
INFO:training log:train mse metric from avg particule: 1.204 - val mse metric from avg particule: 1.238
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2043194> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.0087557975> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.0013501908> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=-0.023545029> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.004669945>
INFO:training log:Time taken for 1 epoch: 386.02647972106934 secs
INFO:training log:Epoch 19/30
INFO:training log:train loss: -102.325 - val loss: -115.263
INFO:training log:train mse metric from avg particule: 1.204 - val mse metric from avg particule: 1.240
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2115244> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.0064688027> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.0007384039> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=-0.02080233> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.0055696014>
INFO:training log:Time taken for 1 epoch: 391.60918855667114 secs
INFO:training log:Epoch 20/30
INFO:training log:train loss: -93.962 - val loss: -87.763
INFO:training log:train mse metric from avg particule: 1.204 - val mse metric from avg particule: 1.239
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.212593> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.024251234> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.015982542> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=-0.0064503797> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.021788407>
INFO:training log:Time taken for 1 epoch: 399.1157228946686 secs
INFO:training log:Epoch 21/30
INFO:training log:train loss: -90.722 - val loss: -97.943
INFO:training log:train mse metric from avg particule: 1.202 - val mse metric from avg particule: 1.237
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2054782> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=-0.00853889> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=0.014212312> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=-0.017773991> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=-0.004620472>
INFO:training log:Time taken for 1 epoch: 404.3567383289337 secs
INFO:training log:Epoch 22/30
INFO:training log:train loss: -90.137 - val loss: -85.595
INFO:training log:train mse metric from avg particule: 1.204 - val mse metric from avg particule: 1.231
INFO:training log:sigma_obs:<tf.Variable 'Sigma_obs:0' shape=() dtype=float32, numpy=1.2056379> - sigma_k:<tf.Variable 'sigma_k:0' shape=() dtype=float32, numpy=0.028767064> - sigma_q: <tf.Variable 'sigma_q:0' shape=() dtype=float32, numpy=-0.019997563> - sigma_v: <tf.Variable 'sigma_v:0' shape=() dtype=float32, numpy=0.019060645> - sigma_z: <tf.Variable 'sigma_z:0' shape=() dtype=float32, numpy=0.0071063675>
INFO:training log:Time taken for 1 epoch: 409.2745234966278 secs
INFO:training log:Epoch 23/30
